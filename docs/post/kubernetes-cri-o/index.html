<!DOCTYPE html>
<html lang="ja" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='環境 Kubernetes 1.31.0 cri-o v1.30.4 参考URL https://github.com/cri-o/packaging/blob/main/README.md https://github.com/cri-o/cri-o/releases cri-oのインストール リポジトリを追加してのインストールと、バイナリをインストールの2種類がある
リポジトリからインストールする 1 sudo apt install software-properties-common curl リポジトリの追加
1 CRIO_VERSION=v1.30 1 2 3 4 5 curl -fsSL https://pkgs.k8s.io/addons:/cri-o:/stable:/$CRIO_VERSION/deb/Release.key | gpg --dearmor -o /etc/apt/keyrings/cri-o-apt-keyring.gpg echo &#34;deb [signed-by=/etc/apt/keyrings/cri-o-apt-keyring.gpg] https://pkgs.k8s.io/addons:/cri-o:/stable:/$CRIO_VERSION/deb/ /&#34; | tee /etc/apt/sources.list.d/cri-o.list 1 2 3 4 5 curl -fsSL https://pkgs.k8s.io/addons:/cri-o:/stable:/v1.30/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/cri-o-apt-keyring.gpg echo &#34;deb [signed-by=/etc/apt/keyrings/cri-o-apt-keyring.gpg] https://pkgs.k8s.io/addons:/cri-o:/stable:/v1.30/deb/ /&#34; | sudo tee /etc/apt/sources.list.d/cri-o.list cri-oをインストールする
1 2 3 4 5 6 sudo apt install cri-o sudo systemctl daemon-reload systemctl enable --now cri-o systemctl start cri-o systemctl status cri-o crio version アンインストール方法'>
<title>cri-oを使用してkubernetesを構築する</title>

<link rel='canonical' href='https://tiisanamaou.github.io/post/kubernetes-cri-o/'>

<link rel="stylesheet" href="../../scss/style.min.d4d4e29b7285e290d59d35be6d50206bd68616b705cbc5f5f9b288dcc2a2eb41.css"><meta property='og:title' content='cri-oを使用してkubernetesを構築する'>
<meta property='og:description' content='環境 Kubernetes 1.31.0 cri-o v1.30.4 参考URL https://github.com/cri-o/packaging/blob/main/README.md https://github.com/cri-o/cri-o/releases cri-oのインストール リポジトリを追加してのインストールと、バイナリをインストールの2種類がある
リポジトリからインストールする 1 sudo apt install software-properties-common curl リポジトリの追加
1 CRIO_VERSION=v1.30 1 2 3 4 5 curl -fsSL https://pkgs.k8s.io/addons:/cri-o:/stable:/$CRIO_VERSION/deb/Release.key | gpg --dearmor -o /etc/apt/keyrings/cri-o-apt-keyring.gpg echo &#34;deb [signed-by=/etc/apt/keyrings/cri-o-apt-keyring.gpg] https://pkgs.k8s.io/addons:/cri-o:/stable:/$CRIO_VERSION/deb/ /&#34; | tee /etc/apt/sources.list.d/cri-o.list 1 2 3 4 5 curl -fsSL https://pkgs.k8s.io/addons:/cri-o:/stable:/v1.30/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/cri-o-apt-keyring.gpg echo &#34;deb [signed-by=/etc/apt/keyrings/cri-o-apt-keyring.gpg] https://pkgs.k8s.io/addons:/cri-o:/stable:/v1.30/deb/ /&#34; | sudo tee /etc/apt/sources.list.d/cri-o.list cri-oをインストールする
1 2 3 4 5 6 sudo apt install cri-o sudo systemctl daemon-reload systemctl enable --now cri-o systemctl start cri-o systemctl status cri-o crio version アンインストール方法'>
<meta property='og:url' content='https://tiisanamaou.github.io/post/kubernetes-cri-o/'>
<meta property='og:site_name' content='onodera memo'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2024-08-25T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2024-08-25T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="cri-oを使用してkubernetesを構築する">
<meta name="twitter:description" content="環境 Kubernetes 1.31.0 cri-o v1.30.4 参考URL https://github.com/cri-o/packaging/blob/main/README.md https://github.com/cri-o/cri-o/releases cri-oのインストール リポジトリを追加してのインストールと、バイナリをインストールの2種類がある
リポジトリからインストールする 1 sudo apt install software-properties-common curl リポジトリの追加
1 CRIO_VERSION=v1.30 1 2 3 4 5 curl -fsSL https://pkgs.k8s.io/addons:/cri-o:/stable:/$CRIO_VERSION/deb/Release.key | gpg --dearmor -o /etc/apt/keyrings/cri-o-apt-keyring.gpg echo &#34;deb [signed-by=/etc/apt/keyrings/cri-o-apt-keyring.gpg] https://pkgs.k8s.io/addons:/cri-o:/stable:/$CRIO_VERSION/deb/ /&#34; | tee /etc/apt/sources.list.d/cri-o.list 1 2 3 4 5 curl -fsSL https://pkgs.k8s.io/addons:/cri-o:/stable:/v1.30/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/cri-o-apt-keyring.gpg echo &#34;deb [signed-by=/etc/apt/keyrings/cri-o-apt-keyring.gpg] https://pkgs.k8s.io/addons:/cri-o:/stable:/v1.30/deb/ /&#34; | sudo tee /etc/apt/sources.list.d/cri-o.list cri-oをインストールする
1 2 3 4 5 6 sudo apt install cri-o sudo systemctl daemon-reload systemctl enable --now cri-o systemctl start cri-o systemctl status cri-o crio version アンインストール方法">
    <link rel="shortcut icon" href="img/favicon.ico" />

  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="メニューを開く・閉じる">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="../../">
                
                    
                    
                    
                        
                        <img src="../../img/avatar_hu16581378458422906.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="../../">onodera memo</a></h1>
            <h2 class="site-description">メモ兼ブログ</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/tiisanamaou'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='../../' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='../../page/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='../../page/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='../../page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
                <li id="i18n-switch">  
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                    <select name="language" onchange="window.location.href = this.selectedOptions[0].value">
                        
                            <option value="https://tiisanamaou.github.io/" selected></option>
                        
                    </select>
                </li>
            
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>ダークモード</span>
                </li>
            
        </div>
    </ol>
</aside>

    

            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="../../categories/kubernetes/" >
                Kubernetes
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="../../post/kubernetes-cri-o/">cri-oを使用してkubernetesを構築する</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2024/08/25</time>
            </div>
        

        
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="環境">環境</h2>
<ul>
<li>Kubernetes 1.31.0</li>
<li>cri-o v1.30.4</li>
</ul>
<h2 id="参考url">参考URL</h2>
<ul>
<li><a class="link" href="https://github.com/cri-o/packaging/blob/main/README.md"  target="_blank" rel="noopener"
    >https://github.com/cri-o/packaging/blob/main/README.md</a></li>
<li><a class="link" href="https://github.com/cri-o/cri-o/releases"  target="_blank" rel="noopener"
    >https://github.com/cri-o/cri-o/releases</a></li>
</ul>
<h2 id="cri-oのインストール">cri-oのインストール</h2>
<p>リポジトリを追加してのインストールと、バイナリをインストールの2種類がある</p>
<h3 id="リポジトリからインストールする">リポジトリからインストールする</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt install software-properties-common curl
</span></span></code></pre></td></tr></table>
</div>
</div><p>リポジトリの追加</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">CRIO_VERSION=v1.30
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">curl -fsSL https://pkgs.k8s.io/addons:/cri-o:/stable:/$CRIO_VERSION/deb/Release.key |
</span></span><span class="line"><span class="cl">    gpg --dearmor -o /etc/apt/keyrings/cri-o-apt-keyring.gpg
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">echo &#34;deb [signed-by=/etc/apt/keyrings/cri-o-apt-keyring.gpg] https://pkgs.k8s.io/addons:/cri-o:/stable:/$CRIO_VERSION/deb/ /&#34; |
</span></span><span class="line"><span class="cl">    tee /etc/apt/sources.list.d/cri-o.list
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">curl -fsSL https://pkgs.k8s.io/addons:/cri-o:/stable:/v1.30/deb/Release.key |
</span></span><span class="line"><span class="cl">    sudo gpg --dearmor -o /etc/apt/keyrings/cri-o-apt-keyring.gpg
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">echo &#34;deb [signed-by=/etc/apt/keyrings/cri-o-apt-keyring.gpg] https://pkgs.k8s.io/addons:/cri-o:/stable:/v1.30/deb/ /&#34; |
</span></span><span class="line"><span class="cl">    sudo tee /etc/apt/sources.list.d/cri-o.list
</span></span></code></pre></td></tr></table>
</div>
</div><p>cri-oをインストールする</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">cri</span><span class="o">-</span><span class="n">o</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
</span></span><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">enable</span> <span class="o">--</span><span class="n">now</span> <span class="n">cri</span><span class="o">-</span><span class="n">o</span>
</span></span><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">start</span> <span class="n">cri</span><span class="o">-</span><span class="n">o</span>
</span></span><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">status</span> <span class="n">cri</span><span class="o">-</span><span class="n">o</span>
</span></span><span class="line"><span class="cl"><span class="n">crio</span> <span class="n">version</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>アンインストール方法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">which crio
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="バイナリをインストール">バイナリをインストール</h3>
<p>上記のリポジトリを追加してインストールか、このバイナリをインストールする方法のどちらでも問題なく動作する<br>
バージョンアップはリポジトリの追加のほうがしやすい</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">wget https://storage.googleapis.com/cri-o/artifacts/cri-o.$ARCH.$REV.tar.gz
</span></span><span class="line"><span class="cl">wget https://storage.googleapis.com/cri-o/artifacts/cri-o.amd64.v1.30.4.tar.gz
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tar -zxvf cri-o.amd64.v1.30.4.tar.gz
</span></span><span class="line"><span class="cl">cd cri-o
</span></span><span class="line"><span class="cl">sudo bash ./install
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mao@k8s-crio-woker-node:~/cri-o$ sudo bash ./install
</span></span><span class="line"><span class="cl">+ DESTDIR=
</span></span><span class="line"><span class="cl">+ PREFIX=/usr/local
</span></span><span class="line"><span class="cl">+ ETCDIR=/etc
</span></span><span class="line"><span class="cl">+ LIBEXECDIR=/usr/libexec
</span></span><span class="line"><span class="cl">+ LIBEXEC_CRIO_DIR=/usr/libexec/crio
</span></span><span class="line"><span class="cl">+ ETC_CRIO_DIR=/etc/crio
</span></span><span class="line"><span class="cl">+ CONTAINERS_DIR=/etc/containers
</span></span><span class="line"><span class="cl">+ CONTAINERS_REGISTRIES_CONFD_DIR=/etc/containers/registries.conf.d
</span></span><span class="line"><span class="cl">+ CNIDIR=/etc/cni/net.d
</span></span><span class="line"><span class="cl">+ BINDIR=/usr/local/bin
</span></span><span class="line"><span class="cl">+ MANDIR=/usr/local/share/man
</span></span><span class="line"><span class="cl">+ OCIDIR=/usr/local/share/oci-umount/oci-umount.d
</span></span><span class="line"><span class="cl">+ BASHINSTALLDIR=/usr/local/share/bash-completion/completions
</span></span><span class="line"><span class="cl">+ FISHINSTALLDIR=/usr/local/share/fish/completions
</span></span><span class="line"><span class="cl">+ ZSHINSTALLDIR=/usr/local/share/zsh/site-functions
</span></span><span class="line"><span class="cl">+ OPT_CNI_BIN_DIR=/opt/cni/bin
</span></span><span class="line"><span class="cl">+ dpkg -l
</span></span><span class="line"><span class="cl">+ SYSCONFIGDIR=/etc/default
</span></span><span class="line"><span class="cl">+ sed -i &#39;s;sysconfig/crio;default/crio;g&#39; etc/crio
</span></span><span class="line"><span class="cl">+ source /etc/os-release
</span></span><span class="line"><span class="cl">++ PRETTY_NAME=&#39;Ubuntu 24.04 LTS&#39;
</span></span><span class="line"><span class="cl">++ NAME=Ubuntu
</span></span><span class="line"><span class="cl">++ VERSION_ID=24.04
</span></span><span class="line"><span class="cl">++ VERSION=&#39;24.04 LTS (Noble Numbat)&#39;
</span></span><span class="line"><span class="cl">++ VERSION_CODENAME=noble
</span></span><span class="line"><span class="cl">++ ID=ubuntu
</span></span><span class="line"><span class="cl">++ ID_LIKE=debian
</span></span><span class="line"><span class="cl">++ HOME_URL=https://www.ubuntu.com/
</span></span><span class="line"><span class="cl">++ SUPPORT_URL=https://help.ubuntu.com/
</span></span><span class="line"><span class="cl">++ BUG_REPORT_URL=https://bugs.launchpad.net/ubuntu/
</span></span><span class="line"><span class="cl">++ PRIVACY_POLICY_URL=https://www.ubuntu.com/legal/terms-and-policies/privacy-policy
</span></span><span class="line"><span class="cl">++ UBUNTU_CODENAME=noble
</span></span><span class="line"><span class="cl">++ LOGO=ubuntu-logo
</span></span><span class="line"><span class="cl">+ [[ ubuntu == \f\e\d\o\r\a ]]
</span></span><span class="line"><span class="cl">+ [[ ubuntu == \r\h\c\o\s ]]
</span></span><span class="line"><span class="cl">+ SYSTEMDDIR=/usr/local/lib/systemd/system
</span></span><span class="line"><span class="cl">+ SELINUX=
</span></span><span class="line"><span class="cl">+ selinuxenabled
</span></span><span class="line"><span class="cl">+ ARCH=amd64
</span></span><span class="line"><span class="cl">+ install -d -m 755 /etc/cni/net.d
</span></span><span class="line"><span class="cl">+ install -D -m 755 -t /opt/cni/bin cni-plugins/LICENSE cni-plugins/README.md cni-plugins/bandwidth cni-plugins/bridge cni-plugins/dhcp cni-plugins/dummy cni-plugins/firewall cni-plugins/host-device cni-plugins/host-local cni-plugins/ipvlan cni-plugins/loopback cni-plugins/macvlan cni-plugins/portmap cni-plugins/ptp cni-plugins/sbr cni-plugins/static cni-plugins/tap cni-plugins/tuning cni-plugins/vlan cni-plugins/vrf
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /etc/cni/net.d contrib/11-crio-ipv4-bridge.conflist
</span></span><span class="line"><span class="cl">+ install -d -m 755 /usr/libexec/crio
</span></span><span class="line"><span class="cl">+ install -D -m 755 -t /usr/libexec/crio bin/conmon
</span></span><span class="line"><span class="cl">+ install -D -m 755 -t /usr/libexec/crio bin/conmonrs
</span></span><span class="line"><span class="cl">+ install -D -m 755 -t /usr/libexec/crio bin/crun
</span></span><span class="line"><span class="cl">+ install -D -m 755 -t /usr/libexec/crio bin/runc
</span></span><span class="line"><span class="cl">+ install -d -m 755 /usr/local/share/bash-completion/completions
</span></span><span class="line"><span class="cl">+ install -d -m 755 /usr/local/share/fish/completions
</span></span><span class="line"><span class="cl">+ install -d -m 755 /usr/local/share/zsh/site-functions
</span></span><span class="line"><span class="cl">+ install -d -m 755 /etc/containers/registries.conf.d
</span></span><span class="line"><span class="cl">+ install -D -m 755 -t /usr/local/bin bin/crio
</span></span><span class="line"><span class="cl">+ install -D -m 755 -t /usr/local/bin bin/pinns
</span></span><span class="line"><span class="cl">+ install -D -m 755 -t /usr/local/bin bin/crictl
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /etc etc/crictl.yaml
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /usr/local/share/oci-umount/oci-umount.d etc/crio-umount.conf
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /etc/default etc/crio
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /etc/crio contrib/policy.json
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /etc/crio/crio.conf.d etc/10-crio.conf
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /usr/local/share/man/man5 man/crio.conf.5
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /usr/local/share/man/man5 man/crio.conf.d.5
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /usr/local/share/man/man8 man/crio.8
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /usr/local/share/bash-completion/completions completions/bash/crio
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /usr/local/share/fish/completions completions/fish/crio.fish
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /usr/local/share/zsh/site-functions completions/zsh/_crio
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /usr/local/lib/systemd/system contrib/crio.service
</span></span><span class="line"><span class="cl">+ install -D -m 644 -t /etc/containers/registries.conf.d contrib/registries.conf
</span></span><span class="line"><span class="cl">+ sed -i &#39;s;/usr/bin;/usr/local/bin;g&#39; /etc/crio/crio.conf.d/10-crio.conf
</span></span><span class="line"><span class="cl">+ sed -i &#39;s;/usr/libexec;/usr/libexec;g&#39; /etc/crio/crio.conf.d/10-crio.conf
</span></span><span class="line"><span class="cl">+ sed -i &#39;s;/etc/crio;/etc/crio;g&#39; /etc/crio/crio.conf.d/10-crio.conf
</span></span><span class="line"><span class="cl">+ &#39;[&#39; -n &#39;&#39; &#39;]&#39;
</span></span><span class="line"><span class="cl">mao@k8s-crio-woker-node:~/cri-o$ 
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="o">--</span><span class="n">now</span> <span class="n">cri</span><span class="o">-</span><span class="n">o</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">cri</span><span class="o">-</span><span class="n">o</span>
</span></span><span class="line"><span class="cl"><span class="n">crio</span> <span class="n">version</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">mao</span><span class="err">@</span><span class="n">k8s</span><span class="o">-</span><span class="n">crio</span><span class="o">-</span><span class="n">woker</span><span class="o">-</span><span class="n">node</span><span class="p">:</span><span class="o">~/</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="o">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
</span></span><span class="line"><span class="cl"><span class="n">mao</span><span class="err">@</span><span class="n">k8s</span><span class="o">-</span><span class="n">crio</span><span class="o">-</span><span class="n">woker</span><span class="o">-</span><span class="n">node</span><span class="p">:</span><span class="o">~/</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="o">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="o">--</span><span class="n">now</span> <span class="n">crio</span>
</span></span><span class="line"><span class="cl"><span class="n">Created</span> <span class="n">symlink</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="o">.</span><span class="n">service</span> <span class="err">→</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">service</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">Created</span> <span class="n">symlink</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">wants</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">service</span> <span class="err">→</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">service</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">mao</span><span class="err">@</span><span class="n">k8s</span><span class="o">-</span><span class="n">crio</span><span class="o">-</span><span class="n">woker</span><span class="o">-</span><span class="n">node</span><span class="p">:</span><span class="o">~/</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="o">$</span> <span class="n">crio</span> <span class="n">version</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">[</span><span class="mi">2024</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">23</span> <span class="mi">23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">44.088388712</span><span class="n">Z</span><span class="p">]</span> <span class="n">Starting</span> <span class="n">CRI</span><span class="o">-</span><span class="n">O</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="mf">1.30</span><span class="o">.</span><span class="mi">4</span><span class="p">,</span> <span class="n">git</span><span class="p">:</span> <span class="n">dbc00ffd41a487c847158032193b6dca9b49e821</span><span class="p">(</span><span class="n">clean</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">Version</span><span class="p">:</span>        <span class="mf">1.30</span><span class="o">.</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="n">GitCommit</span><span class="p">:</span>      <span class="n">dbc00ffd41a487c847158032193b6dca9b49e821</span>
</span></span><span class="line"><span class="cl"><span class="n">GitCommitDate</span><span class="p">:</span>  <span class="mi">2024</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">01</span><span class="n">T06</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">46</span><span class="n">Z</span>
</span></span><span class="line"><span class="cl"><span class="n">GitTreeState</span><span class="p">:</span>   <span class="n">clean</span>
</span></span><span class="line"><span class="cl"><span class="n">BuildDate</span><span class="p">:</span>      <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="n">Z</span>
</span></span><span class="line"><span class="cl"><span class="n">GoVersion</span><span class="p">:</span>      <span class="n">go1</span><span class="o">.</span><span class="mf">22.0</span>
</span></span><span class="line"><span class="cl"><span class="n">Compiler</span><span class="p">:</span>       <span class="n">gc</span>
</span></span><span class="line"><span class="cl"><span class="n">Platform</span><span class="p">:</span>       <span class="n">linux</span><span class="o">/</span><span class="n">amd64</span>
</span></span><span class="line"><span class="cl"><span class="n">Linkmode</span><span class="p">:</span>       <span class="k">static</span>
</span></span><span class="line"><span class="cl"><span class="n">BuildTags</span><span class="p">:</span>      
</span></span><span class="line"><span class="cl">  <span class="k">static</span>
</span></span><span class="line"><span class="cl">  <span class="n">netgo</span>
</span></span><span class="line"><span class="cl">  <span class="n">osusergo</span>
</span></span><span class="line"><span class="cl">  <span class="n">exclude_graphdriver_btrfs</span>
</span></span><span class="line"><span class="cl">  <span class="n">exclude_graphdriver_devicemapper</span>
</span></span><span class="line"><span class="cl">  <span class="n">seccomp</span>
</span></span><span class="line"><span class="cl">  <span class="n">apparmor</span>
</span></span><span class="line"><span class="cl">  <span class="n">selinux</span>
</span></span><span class="line"><span class="cl"><span class="n">LDFlags</span><span class="p">:</span>          <span class="n">unknown</span>
</span></span><span class="line"><span class="cl"><span class="n">SeccompEnabled</span><span class="p">:</span>   <span class="bp">true</span>
</span></span><span class="line"><span class="cl"><span class="n">AppArmorEnabled</span><span class="p">:</span>  <span class="bp">false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mao</span><span class="err">@</span><span class="n">k8s</span><span class="o">-</span><span class="n">crio</span><span class="o">-</span><span class="n">woker</span><span class="o">-</span><span class="n">node</span><span class="p">:</span><span class="o">~/</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="o">$</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="nanoをインストール">nanoをインストール</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt install nano
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="スワップメモリとipアドレスの設定">スワップメモリとIPアドレスの設定</h2>
<p>スワップをオフにする</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo swapoff -a
</span></span><span class="line"><span class="cl">sudo nano /etc/fstab
</span></span><span class="line"><span class="cl">free -h
</span></span></code></pre></td></tr></table>
</div>
</div><p>IPアドレスを固定する</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ip link
</span></span><span class="line"><span class="cl">ip address
</span></span><span class="line"><span class="cl">sudo cp 99-config.yaml /etc/netplan/
</span></span><span class="line"><span class="cl">sudo netplan apply try --timeout 10
</span></span><span class="line"><span class="cl">sudo netplan apply
</span></span><span class="line"><span class="cl">sudo chmod 600 /etc/netplan/99-config.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="カーネルパラメーター設定">カーネルパラメーター設定</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">cat</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">modules</span><span class="o">-</span><span class="nb">load</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">k8s</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl"><span class="n">overlay</span>
</span></span><span class="line"><span class="cl"><span class="n">br_netfilter</span>
</span></span><span class="line"><span class="cl"><span class="n">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">modprobe</span> <span class="n">overlay</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">modprobe</span> <span class="n">br_netfilter</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># この構成に必要なカーネルパラメーター、再起動しても値は永続します</span>
</span></span><span class="line"><span class="cl"><span class="n">cat</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysctl</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">k8s</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl"><span class="n">net</span><span class="o">.</span><span class="n">bridge</span><span class="o">.</span><span class="n">bridge</span><span class="o">-</span><span class="n">nf</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">iptables</span>  <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">net</span><span class="o">.</span><span class="n">bridge</span><span class="o">.</span><span class="n">bridge</span><span class="o">-</span><span class="n">nf</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">ip6tables</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">net</span><span class="o">.</span><span class="n">ipv4</span><span class="o">.</span><span class="n">ip_forward</span>                 <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 再起動せずにカーネルパラメーターを適用</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">sysctl</span> <span class="o">--</span><span class="n">system</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">lsmod | grep br_netfilter
</span></span><span class="line"><span class="cl">lsmod | grep overlay
</span></span><span class="line"><span class="cl">sysctl net.bridge.bridge-nf-call-iptables net.bridge.bridge-nf-call-ip6tables net.ipv4.ip_forward
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="cgroupfsの設定">Cgroupfsの設定</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">stat -fc %T /sys/fs/cgroup/
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo crio config default | sudo tee /etc/crio/crio.conf
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span><span class="lnt">449
</span><span class="lnt">450
</span><span class="lnt">451
</span><span class="lnt">452
</span><span class="lnt">453
</span><span class="lnt">454
</span><span class="lnt">455
</span><span class="lnt">456
</span><span class="lnt">457
</span><span class="lnt">458
</span><span class="lnt">459
</span><span class="lnt">460
</span><span class="lnt">461
</span><span class="lnt">462
</span><span class="lnt">463
</span><span class="lnt">464
</span><span class="lnt">465
</span><span class="lnt">466
</span><span class="lnt">467
</span><span class="lnt">468
</span><span class="lnt">469
</span><span class="lnt">470
</span><span class="lnt">471
</span><span class="lnt">472
</span><span class="lnt">473
</span><span class="lnt">474
</span><span class="lnt">475
</span><span class="lnt">476
</span><span class="lnt">477
</span><span class="lnt">478
</span><span class="lnt">479
</span><span class="lnt">480
</span><span class="lnt">481
</span><span class="lnt">482
</span><span class="lnt">483
</span><span class="lnt">484
</span><span class="lnt">485
</span><span class="lnt">486
</span><span class="lnt">487
</span><span class="lnt">488
</span><span class="lnt">489
</span><span class="lnt">490
</span><span class="lnt">491
</span><span class="lnt">492
</span><span class="lnt">493
</span><span class="lnt">494
</span><span class="lnt">495
</span><span class="lnt">496
</span><span class="lnt">497
</span><span class="lnt">498
</span><span class="lnt">499
</span><span class="lnt">500
</span><span class="lnt">501
</span><span class="lnt">502
</span><span class="lnt">503
</span><span class="lnt">504
</span><span class="lnt">505
</span><span class="lnt">506
</span><span class="lnt">507
</span><span class="lnt">508
</span><span class="lnt">509
</span><span class="lnt">510
</span><span class="lnt">511
</span><span class="lnt">512
</span><span class="lnt">513
</span><span class="lnt">514
</span><span class="lnt">515
</span><span class="lnt">516
</span><span class="lnt">517
</span><span class="lnt">518
</span><span class="lnt">519
</span><span class="lnt">520
</span><span class="lnt">521
</span><span class="lnt">522
</span><span class="lnt">523
</span><span class="lnt">524
</span><span class="lnt">525
</span><span class="lnt">526
</span><span class="lnt">527
</span><span class="lnt">528
</span><span class="lnt">529
</span><span class="lnt">530
</span><span class="lnt">531
</span><span class="lnt">532
</span><span class="lnt">533
</span><span class="lnt">534
</span><span class="lnt">535
</span><span class="lnt">536
</span><span class="lnt">537
</span><span class="lnt">538
</span><span class="lnt">539
</span><span class="lnt">540
</span><span class="lnt">541
</span><span class="lnt">542
</span><span class="lnt">543
</span><span class="lnt">544
</span><span class="lnt">545
</span><span class="lnt">546
</span><span class="lnt">547
</span><span class="lnt">548
</span><span class="lnt">549
</span><span class="lnt">550
</span><span class="lnt">551
</span><span class="lnt">552
</span><span class="lnt">553
</span><span class="lnt">554
</span><span class="lnt">555
</span><span class="lnt">556
</span><span class="lnt">557
</span><span class="lnt">558
</span><span class="lnt">559
</span><span class="lnt">560
</span><span class="lnt">561
</span><span class="lnt">562
</span><span class="lnt">563
</span><span class="lnt">564
</span><span class="lnt">565
</span><span class="lnt">566
</span><span class="lnt">567
</span><span class="lnt">568
</span><span class="lnt">569
</span><span class="lnt">570
</span><span class="lnt">571
</span><span class="lnt">572
</span><span class="lnt">573
</span><span class="lnt">574
</span><span class="lnt">575
</span><span class="lnt">576
</span><span class="lnt">577
</span><span class="lnt">578
</span><span class="lnt">579
</span><span class="lnt">580
</span><span class="lnt">581
</span><span class="lnt">582
</span><span class="lnt">583
</span><span class="lnt">584
</span><span class="lnt">585
</span><span class="lnt">586
</span><span class="lnt">587
</span><span class="lnt">588
</span><span class="lnt">589
</span><span class="lnt">590
</span><span class="lnt">591
</span><span class="lnt">592
</span><span class="lnt">593
</span><span class="lnt">594
</span><span class="lnt">595
</span><span class="lnt">596
</span><span class="lnt">597
</span><span class="lnt">598
</span><span class="lnt">599
</span><span class="lnt">600
</span><span class="lnt">601
</span><span class="lnt">602
</span><span class="lnt">603
</span><span class="lnt">604
</span><span class="lnt">605
</span><span class="lnt">606
</span><span class="lnt">607
</span><span class="lnt">608
</span><span class="lnt">609
</span><span class="lnt">610
</span><span class="lnt">611
</span><span class="lnt">612
</span><span class="lnt">613
</span><span class="lnt">614
</span><span class="lnt">615
</span><span class="lnt">616
</span><span class="lnt">617
</span><span class="lnt">618
</span><span class="lnt">619
</span><span class="lnt">620
</span><span class="lnt">621
</span><span class="lnt">622
</span><span class="lnt">623
</span><span class="lnt">624
</span><span class="lnt">625
</span><span class="lnt">626
</span><span class="lnt">627
</span><span class="lnt">628
</span><span class="lnt">629
</span><span class="lnt">630
</span><span class="lnt">631
</span><span class="lnt">632
</span><span class="lnt">633
</span><span class="lnt">634
</span><span class="lnt">635
</span><span class="lnt">636
</span><span class="lnt">637
</span><span class="lnt">638
</span><span class="lnt">639
</span><span class="lnt">640
</span><span class="lnt">641
</span><span class="lnt">642
</span><span class="lnt">643
</span><span class="lnt">644
</span><span class="lnt">645
</span><span class="lnt">646
</span><span class="lnt">647
</span><span class="lnt">648
</span><span class="lnt">649
</span><span class="lnt">650
</span><span class="lnt">651
</span><span class="lnt">652
</span><span class="lnt">653
</span><span class="lnt">654
</span><span class="lnt">655
</span><span class="lnt">656
</span><span class="lnt">657
</span><span class="lnt">658
</span><span class="lnt">659
</span><span class="lnt">660
</span><span class="lnt">661
</span><span class="lnt">662
</span><span class="lnt">663
</span><span class="lnt">664
</span><span class="lnt">665
</span><span class="lnt">666
</span><span class="lnt">667
</span><span class="lnt">668
</span><span class="lnt">669
</span><span class="lnt">670
</span><span class="lnt">671
</span><span class="lnt">672
</span><span class="lnt">673
</span><span class="lnt">674
</span><span class="lnt">675
</span><span class="lnt">676
</span><span class="lnt">677
</span><span class="lnt">678
</span><span class="lnt">679
</span><span class="lnt">680
</span><span class="lnt">681
</span><span class="lnt">682
</span><span class="lnt">683
</span><span class="lnt">684
</span><span class="lnt">685
</span><span class="lnt">686
</span><span class="lnt">687
</span><span class="lnt">688
</span><span class="lnt">689
</span><span class="lnt">690
</span><span class="lnt">691
</span><span class="lnt">692
</span><span class="lnt">693
</span><span class="lnt">694
</span><span class="lnt">695
</span><span class="lnt">696
</span><span class="lnt">697
</span><span class="lnt">698
</span><span class="lnt">699
</span><span class="lnt">700
</span><span class="lnt">701
</span><span class="lnt">702
</span><span class="lnt">703
</span><span class="lnt">704
</span><span class="lnt">705
</span><span class="lnt">706
</span><span class="lnt">707
</span><span class="lnt">708
</span><span class="lnt">709
</span><span class="lnt">710
</span><span class="lnt">711
</span><span class="lnt">712
</span><span class="lnt">713
</span><span class="lnt">714
</span><span class="lnt">715
</span><span class="lnt">716
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">mao</span><span class="err">@</span><span class="n">mao</span><span class="o">-</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="p">:</span><span class="o">~$</span> <span class="n">sudo</span> <span class="n">crio</span> <span class="n">config</span> <span class="n">default</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">[</span><span class="mi">2024</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">23</span> <span class="mi">12</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">11.597692695</span><span class="n">Z</span><span class="p">]</span> <span class="n">Starting</span> <span class="n">CRI</span><span class="o">-</span><span class="n">O</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="mf">1.30</span><span class="o">.</span><span class="mi">4</span><span class="p">,</span> <span class="n">git</span><span class="p">:</span> <span class="n">dbc00ffd41a487c847158032193b6dca9b49e821</span><span class="p">(</span><span class="n">clean</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">INFO</span> <span class="n">Using</span> <span class="n">default</span> <span class="n">capabilities</span><span class="p">:</span> <span class="n">CAP_CHOWN</span><span class="p">,</span> <span class="n">CAP_DAC_OVERRIDE</span><span class="p">,</span> <span class="n">CAP_FSETID</span><span class="p">,</span> <span class="n">CAP_FOWNER</span><span class="p">,</span> <span class="n">CAP_SETGID</span><span class="p">,</span> <span class="n">CAP_SETUID</span><span class="p">,</span> <span class="n">CAP_SETPCAP</span><span class="p">,</span> <span class="n">CAP_NET_BIND_SERVICE</span><span class="p">,</span> <span class="n">CAP_KILL</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># The CRI-O configuration file specifies all of the available configuration</span>
</span></span><span class="line"><span class="cl"><span class="c1"># options and command-line flags for the crio(8) OCI Kubernetes Container Runtime</span>
</span></span><span class="line"><span class="cl"><span class="c1"># daemon, but in a TOML format that can be more easily modified and versioned.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Please refer to crio.conf(5) for details of all configuration options.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CRI-O supports partial configuration reload during runtime, which can be</span>
</span></span><span class="line"><span class="cl"><span class="c1"># done by sending SIGHUP to the running process. Currently supported options</span>
</span></span><span class="line"><span class="cl"><span class="c1"># are explicitly mentioned with: &#39;This option supports live configuration</span>
</span></span><span class="line"><span class="cl"><span class="c1"># reload&#39;.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CRI-O reads its storage defaults from the containers-storage.conf(5) file</span>
</span></span><span class="line"><span class="cl"><span class="c1"># located at /etc/containers/storage.conf. Modify this storage configuration if</span>
</span></span><span class="line"><span class="cl"><span class="c1"># you want to change the system&#39;s defaults. If you want to modify storage just</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for CRI-O, you can change the storage configuration options here.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">crio</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the &#34;root directory&#34;. CRI-O stores all of its data, including</span>
</span></span><span class="line"><span class="cl"><span class="c1"># containers images, in this directory.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># root = &#34;/var/lib/containers/storage&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the &#34;run directory&#34;. CRI-O stores all of its state in this directory.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># runroot = &#34;/run/containers/storage&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the &#34;imagestore&#34;. If CRI-O stores all of its images in this directory differently than Root.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># imagestore = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Storage driver used to manage the storage of images and containers. Please</span>
</span></span><span class="line"><span class="cl"><span class="c1"># refer to containers-storage.conf(5) to see all available storage drivers.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># storage_driver = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># List to pass options to the storage driver. Please refer to</span>
</span></span><span class="line"><span class="cl"><span class="c1"># containers-storage.conf(5) to see all available storage options.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># storage_option = [</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The default log directory where all logs will go unless directly specified by</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the kubelet. The log directory specified must be an absolute directory.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># log_dir = &#34;/var/log/crio/pods&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Location for CRI-O to lay down the temporary version file.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># It is used to check if crio wipe should wipe containers, which should</span>
</span></span><span class="line"><span class="cl"><span class="c1"># always happen on a node reboot</span>
</span></span><span class="line"><span class="cl"><span class="c1"># version_file = &#34;/var/run/crio/version&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Location for CRI-O to lay down the persistent version file.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># It is used to check if crio wipe should wipe images, which should</span>
</span></span><span class="line"><span class="cl"><span class="c1"># only happen when CRI-O has been upgraded</span>
</span></span><span class="line"><span class="cl"><span class="c1"># version_file_persist = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># InternalWipe is whether CRI-O should wipe containers and images after a reboot when the server starts.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If set to false, one must use the external command &#39;crio wipe&#39; to wipe the containers and images in these situations.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># internal_wipe = true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># InternalRepair is whether CRI-O should check if the container and image storage was corrupted after a sudden restart.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If it was, CRI-O also attempts to repair the storage.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># internal_repair = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Location for CRI-O to lay down the clean shutdown file.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># It is used to check whether crio had time to sync before shutting down.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If not found, crio wipe will clear the storage directory.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># clean_shutdown_file = &#34;/var/lib/crio/clean.shutdown&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The crio.api table contains settings for the kubelet/gRPC interface.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">crio</span><span class="o">.</span><span class="n">api</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to AF_LOCAL socket on which CRI-O will listen.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># listen = &#34;/var/run/crio/crio.sock&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># IP address on which the stream server will listen.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stream_address = &#34;127.0.0.1&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The port on which the stream server will listen. If the port is set to &#34;0&#34;, then</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CRI-O will allocate a random free port number.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stream_port = &#34;0&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Enable encrypted TLS transport of the stream server.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stream_enable_tls = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Length of time until open streams terminate due to lack of activity</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stream_idle_timeout = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the x509 certificate file used to serve the encrypted stream. This</span>
</span></span><span class="line"><span class="cl"><span class="c1"># file can change, and CRI-O will automatically pick up the changes within 5</span>
</span></span><span class="line"><span class="cl"><span class="c1"># minutes.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stream_tls_cert = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the key file used to serve the encrypted stream. This file can</span>
</span></span><span class="line"><span class="cl"><span class="c1"># change and CRI-O will automatically pick up the changes within 5 minutes.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stream_tls_key = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the x509 CA(s) file used to verify and authenticate client</span>
</span></span><span class="line"><span class="cl"><span class="c1"># communication with the encrypted stream. This file can change and CRI-O will</span>
</span></span><span class="line"><span class="cl"><span class="c1"># automatically pick up the changes within 5 minutes.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stream_tls_ca = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Maximum grpc send message size in bytes. If not set or &lt;=0, then CRI-O will default to 80 * 1024 * 1024.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># grpc_max_send_msg_size = 83886080</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Maximum grpc receive message size. If not set or &lt;= 0, then CRI-O will default to 80 * 1024 * 1024.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># grpc_max_recv_msg_size = 83886080</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The crio.runtime table contains settings pertaining to the OCI runtime used</span>
</span></span><span class="line"><span class="cl"><span class="c1"># and options for how to set up and manage the OCI runtime.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">crio</span><span class="o">.</span><span class="n">runtime</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># A list of ulimits to be set in containers by default, specified as</span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#34;&lt;ulimit name&gt;=&lt;soft limit&gt;:&lt;hard limit&gt;&#34;, for example:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#34;nofile=1024:2048&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If nothing is set here, settings will be inherited from the CRI-O daemon</span>
</span></span><span class="line"><span class="cl"><span class="c1"># default_ulimits = [</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># If true, the runtime will not use pivot_root, but instead use MS_MOVE.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># no_pivot = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># decryption_keys_path is the path where the keys required for</span>
</span></span><span class="line"><span class="cl"><span class="c1"># image decryption are stored. This option supports live configuration reload.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># decryption_keys_path = &#34;/etc/crio/keys/&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the conmon binary, used for monitoring the OCI runtime.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Will be searched for using $PATH if empty.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option is currently deprecated, and will be replaced with RuntimeHandler.MonitorEnv.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># conmon = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cgroup setting for conmon</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option is currently deprecated, and will be replaced with RuntimeHandler.MonitorCgroup.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># conmon_cgroup = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Environment variable list for the conmon process, used for passing necessary</span>
</span></span><span class="line"><span class="cl"><span class="c1"># environment variables to conmon or the runtime.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option is currently deprecated, and will be replaced with RuntimeHandler.MonitorEnv.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># conmon_env = [</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Additional environment variables to set for all the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># containers. These are overridden if set in the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># container image spec or in the container runtime configuration.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># default_env = [</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># If true, SELinux will be used for pod separation on the host.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option is deprecated, and be interpreted from whether SELinux is enabled on the host in the future.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># selinux = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the seccomp.json profile which is used as the default seccomp profile</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for the runtime. If not specified, then the internal default seccomp profile</span>
</span></span><span class="line"><span class="cl"><span class="c1"># will be used. This option supports live configuration reload.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># seccomp_profile = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Used to change the name of the default AppArmor profile of CRI-O. The default</span>
</span></span><span class="line"><span class="cl"><span class="c1"># profile name is &#34;crio-default&#34;. This profile only takes effect if the user</span>
</span></span><span class="line"><span class="cl"><span class="c1"># does not specify a profile via the Kubernetes Pod&#39;s metadata annotation. If</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the profile is set to &#34;unconfined&#34;, then this equals to disabling AppArmor.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option supports live configuration reload.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># apparmor_profile = &#34;crio-default&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the blockio class configuration file for configuring</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the cgroup blockio controller.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># blockio_config_file = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Reload blockio-config-file and rescan blockio devices in the system before applying</span>
</span></span><span class="line"><span class="cl"><span class="c1"># blockio parameters.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># blockio_reload = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Used to change irqbalance service config file path which is used for configuring</span>
</span></span><span class="line"><span class="cl"><span class="c1"># irqbalance daemon.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># irqbalance_config_file = &#34;/etc/sysconfig/irqbalance&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># irqbalance_config_restore_file allows to set a cpu mask CRI-O should</span>
</span></span><span class="line"><span class="cl"><span class="c1"># restore as irqbalance config at startup. Set to empty string to disable this flow entirely.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># By default, CRI-O manages the irqbalance configuration to enable dynamic IRQ pinning.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># irqbalance_config_restore_file = &#34;/etc/sysconfig/orig_irq_banned_cpus&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the RDT configuration file for configuring the resctrl pseudo-filesystem.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option supports live configuration reload.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># rdt_config_file = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cgroup management implementation used for the runtime.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cgroup_manager = &#34;systemd&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Specify whether the image pull must be performed in a separate cgroup.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># separate_pull_cgroup = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># List of default capabilities for containers. If it is empty or commented out,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># only the capabilities defined in the containers json file by the user/kube</span>
</span></span><span class="line"><span class="cl"><span class="c1"># will be added.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># default_capabilities = [</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;CHOWN&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;DAC_OVERRIDE&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;FSETID&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;FOWNER&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;SETGID&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;SETUID&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;SETPCAP&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;NET_BIND_SERVICE&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;KILL&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Add capabilities to the inheritable set, as well as the default group of permitted, bounding and effective.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If capabilities are expected to work for non-root users, this option should be set.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># add_inheritable_capabilities = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># List of default sysctls. If it is empty or commented out, only the sysctls</span>
</span></span><span class="line"><span class="cl"><span class="c1"># defined in the container json file by the user/kube will be added.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># default_sysctls = [</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># List of devices on the host that a</span>
</span></span><span class="line"><span class="cl"><span class="c1"># user can specify with the &#34;io.kubernetes.cri-o.Devices&#34; allowed annotation.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># allowed_devices = [</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;/dev/fuse&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># List of additional devices. specified as</span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#34;&lt;device-on-host&gt;:&lt;device-on-container&gt;:&lt;permissions&gt;&#34;, for example: &#34;--device=/dev/sdc:/dev/xvdc:rwm&#34;.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If it is empty or commented out, only the devices</span>
</span></span><span class="line"><span class="cl"><span class="c1"># defined in the container json file by the user/kube will be added.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># additional_devices = [</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># List of directories to scan for CDI Spec files.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cdi_spec_dirs = [</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;/etc/cdi&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;/var/run/cdi&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Change the default behavior of setting container devices uid/gid from CRI&#39;s</span>
</span></span><span class="line"><span class="cl"><span class="c1"># SecurityContext (RunAsUser/RunAsGroup) instead of taking host&#39;s uid/gid.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Defaults to false.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># device_ownership_from_security_context = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to OCI hooks directories for automatically executed hooks. If one of the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># directories does not exist, then CRI-O will automatically skip them.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># hooks_dir = [</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;/usr/share/containers/oci/hooks.d&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the file specifying the defaults mounts for each container. The</span>
</span></span><span class="line"><span class="cl"><span class="c1"># format of the config is /SRC:/DST, one mount per line. Notice that CRI-O reads</span>
</span></span><span class="line"><span class="cl"><span class="c1"># its default mounts from the following two files:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   1) /etc/containers/mounts.conf (i.e., default_mounts_file): This is the</span>
</span></span><span class="line"><span class="cl"><span class="c1">#      override file, where users can either add in their own default mounts, or</span>
</span></span><span class="line"><span class="cl"><span class="c1">#      override the default mounts shipped with the package.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   2) /usr/share/containers/mounts.conf: This is the default file read for</span>
</span></span><span class="line"><span class="cl"><span class="c1">#      mounts. If you want CRI-O to read from a different, specific mounts file,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#      you can change the default_mounts_file. Note, if this is done, CRI-O will</span>
</span></span><span class="line"><span class="cl"><span class="c1">#      only add mounts it finds in this file.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># default_mounts_file = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Maximum number of processes allowed in a container.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option is deprecated. The Kubelet flag &#39;--pod-pids-limit&#39; should be used instead.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># pids_limit = -1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Maximum sized allowed for the container log file. Negative numbers indicate</span>
</span></span><span class="line"><span class="cl"><span class="c1"># that no size limit is imposed. If it is positive, it must be &gt;= 8192 to</span>
</span></span><span class="line"><span class="cl"><span class="c1"># match/exceed conmon&#39;s read buffer. The file is truncated and re-opened so the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># limit is never exceeded. This option is deprecated. The Kubelet flag &#39;--container-log-max-size&#39; should be used instead.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># log_size_max = -1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Whether container output should be logged to journald in addition to the kubernetes log file</span>
</span></span><span class="line"><span class="cl"><span class="c1"># log_to_journald = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to directory in which container exit files are written to by conmon.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># container_exits_dir = &#34;/var/run/crio/exits&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to directory for container attach sockets.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># container_attach_socket_dir = &#34;/var/run/crio&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The prefix to use for the source of the bind mounts.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># bind_mount_prefix = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># If set to true, all containers will run in read-only mode.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># read_only = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Changes the verbosity of the logs based on the level it is set to. Options</span>
</span></span><span class="line"><span class="cl"><span class="c1"># are fatal, panic, error, warn, info, debug and trace. This option supports</span>
</span></span><span class="line"><span class="cl"><span class="c1"># live configuration reload.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># log_level = &#34;info&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Filter the log messages by the provided regular expression.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option supports live configuration reload.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># log_filter = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The UID mappings for the user namespace of each container. A range is</span>
</span></span><span class="line"><span class="cl"><span class="c1"># specified in the form containerUID:HostUID:Size. Multiple ranges must be</span>
</span></span><span class="line"><span class="cl"><span class="c1"># separated by comma.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option is deprecated, and will be replaced with Kubernetes user namespace support (KEP-127) in the future.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># uid_mappings = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The GID mappings for the user namespace of each container. A range is</span>
</span></span><span class="line"><span class="cl"><span class="c1"># specified in the form containerGID:HostGID:Size. Multiple ranges must be</span>
</span></span><span class="line"><span class="cl"><span class="c1"># separated by comma.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option is deprecated, and will be replaced with Kubernetes user namespace support (KEP-127) in the future.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># gid_mappings = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># If set, CRI-O will reject any attempt to map host UIDs below this value</span>
</span></span><span class="line"><span class="cl"><span class="c1"># into user namespaces.  A negative value indicates that no minimum is set,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># so specifying mappings will only be allowed for pods that run as UID 0.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option is deprecated, and will be replaced with Kubernetes user namespace support (KEP-127) in the future.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># minimum_mappable_uid = -1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># If set, CRI-O will reject any attempt to map host GIDs below this value</span>
</span></span><span class="line"><span class="cl"><span class="c1"># into user namespaces.  A negative value indicates that no minimum is set,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># so specifying mappings will only be allowed for pods that run as UID 0.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option is deprecated, and will be replaced with Kubernetes user namespace support (KEP-127) in the future.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># minimum_mappable_gid = -1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The minimal amount of time in seconds to wait before issuing a timeout</span>
</span></span><span class="line"><span class="cl"><span class="c1"># regarding the proper termination of the container. The lowest possible</span>
</span></span><span class="line"><span class="cl"><span class="c1"># value is 30s, whereas lower values are not considered by CRI-O.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ctr_stop_timeout = 30</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># drop_infra_ctr determines whether CRI-O drops the infra container</span>
</span></span><span class="line"><span class="cl"><span class="c1"># when a pod does not have a private PID namespace, and does not use</span>
</span></span><span class="line"><span class="cl"><span class="c1"># a kernel separating runtime (like kata).</span>
</span></span><span class="line"><span class="cl"><span class="c1"># It requires manage_ns_lifecycle to be true.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># drop_infra_ctr = true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># infra_ctr_cpuset determines what CPUs will be used to run infra containers.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># You can use linux CPU list format to specify desired CPUs.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To get better isolation for guaranteed pods, set this parameter to be equal to kubelet reserved-cpus.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># infra_ctr_cpuset = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># shared_cpuset  determines the CPU set which is allowed to be shared between guaranteed containers,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># regardless of, and in addition to, the exclusiveness of their CPUs.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This field is optional and would not be used if not specified.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># You can specify CPUs in the Linux CPU list format.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shared_cpuset = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The directory where the state of the managed namespaces gets tracked.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Only used when manage_ns_lifecycle is true.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># namespaces_dir = &#34;/var/run&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># pinns_path is the path to find the pinns binary, which is needed to manage namespace lifecycle</span>
</span></span><span class="line"><span class="cl"><span class="c1"># pinns_path = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Globally enable/disable CRIU support which is necessary to</span>
</span></span><span class="line"><span class="cl"><span class="c1"># checkpoint and restore container or pods (even if CRIU is found in $PATH).</span>
</span></span><span class="line"><span class="cl"><span class="c1"># enable_criu_support = true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Enable/disable the generation of the container,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># sandbox lifecycle events to be sent to the Kubelet to optimize the PLEG</span>
</span></span><span class="line"><span class="cl"><span class="c1"># enable_pod_events = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># default_runtime is the _name_ of the OCI runtime to be used as the default.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The name is matched against the runtimes map below.</span>
</span></span><span class="line"><span class="cl"><span class="n">default_runtime</span> <span class="o">=</span> <span class="s2">&#34;crun&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># A list of paths that, when absent from the host,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># will cause a container creation to fail (as opposed to the current behavior being created as a directory).</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option is to protect from source locations whose existence as a directory could jeopardize the health of the node, and whose</span>
</span></span><span class="line"><span class="cl"><span class="c1"># creation as a file is not desired either.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># An example is /etc/hostname, which will cause failures on reboot if it&#39;s created as a directory, but often doesn&#39;t exist because</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the hostname is being managed dynamically.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># absent_mount_sources_to_reject = [</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The &#34;crio.runtime.runtimes&#34; table defines a list of OCI compatible runtimes.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The runtime to use is picked based on the runtime handler provided by the CRI.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If no runtime handler is provided, the &#34;default_runtime&#34; will be used.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Each entry in the table should follow the format:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [crio.runtime.runtimes.runtime-handler]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># runtime_path = &#34;/path/to/the/executable&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># runtime_type = &#34;oci&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># runtime_root = &#34;/path/to/the/root&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># monitor_path = &#34;/path/to/container/monitor&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># monitor_cgroup = &#34;/cgroup/path&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># monitor_exec_cgroup = &#34;/cgroup/path&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># monitor_env = []</span>
</span></span><span class="line"><span class="cl"><span class="c1"># privileged_without_host_devices = false</span>
</span></span><span class="line"><span class="cl"><span class="c1"># allowed_annotations = []</span>
</span></span><span class="line"><span class="cl"><span class="c1"># platform_runtime_paths = { &#34;os/arch&#34; = &#34;/path/to/binary&#34; }</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Where:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - runtime-handler: Name used to identify the runtime.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - runtime_path (optional, string): Absolute path to the runtime executable in</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   the host filesystem. If omitted, the runtime-handler identifier should match</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   the runtime executable name, and the runtime executable should be placed</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   in $PATH.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - runtime_type (optional, string): Type of runtime, one of: &#34;oci&#34;, &#34;vm&#34;. If</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   omitted, an &#34;oci&#34; runtime is assumed.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - runtime_root (optional, string): Root directory for storage of containers</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   state.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - runtime_config_path (optional, string): the path for the runtime configuration</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   file. This can only be used with when using the VM runtime_type.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - privileged_without_host_devices (optional, bool): an option for restricting</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   host devices from being passed to privileged containers.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - allowed_annotations (optional, array of strings): an option for specifying</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   a list of experimental annotations that this runtime handler is allowed to process.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   The currently recognized values are:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   &#34;io.kubernetes.cri-o.userns-mode&#34; for configuring a user namespace for the pod.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   &#34;io.kubernetes.cri-o.cgroup2-mount-hierarchy-rw&#34; for mounting cgroups writably when set to &#34;true&#34;.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   &#34;io.kubernetes.cri-o.Devices&#34; for configuring devices for the pod.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   &#34;io.kubernetes.cri-o.ShmSize&#34; for configuring the size of /dev/shm.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   &#34;io.kubernetes.cri-o.UnifiedCgroup.$CTR_NAME&#34; for configuring the cgroup v2 unified block for a container.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   &#34;io.containers.trace-syscall&#34; for tracing syscalls via the OCI seccomp BPF hook.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   &#34;io.kubernetes.cri-o.seccompNotifierAction&#34; for enabling the seccomp notifier feature.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   &#34;io.kubernetes.cri-o.umask&#34; for setting the umask for container init process.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   &#34;io.kubernetes.cri.rdt-class&#34; for setting the RDT class of a container</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   &#34;seccomp-profile.kubernetes.cri-o.io&#34; for setting the seccomp profile for:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     - a specific container by using: &#34;seccomp-profile.kubernetes.cri-o.io/&lt;CONTAINER_NAME&gt;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     - a whole pod by using: &#34;seccomp-profile.kubernetes.cri-o.io/POD&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     Note that the annotation works on containers as well as on images.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     For images, the plain annotation &#34;seccomp-profile.kubernetes.cri-o.io&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     can be used without the required &#34;/POD&#34; suffix or a container name.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   &#34;io.kubernetes.cri-o.DisableFIPS&#34; for disabling FIPS mode in a Kubernetes pod within a FIPS-enabled cluster.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - monitor_path (optional, string): The path of the monitor binary. Replaces</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   deprecated option &#34;conmon&#34;.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - monitor_cgroup (optional, string): The cgroup the container monitor process will be put in.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   Replaces deprecated option &#34;conmon_cgroup&#34;.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - monitor_exec_cgroup (optional, string): If set to &#34;container&#34;, indicates exec probes</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   should be moved to the container&#39;s cgroup</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - monitor_env (optional, array of strings): Environment variables to pass to the montior.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   Replaces deprecated option &#34;conmon_env&#34;.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - platform_runtime_paths (optional, map): A mapping of platforms to the corresponding</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   runtime executable paths for the runtime handler.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - container_min_memory (optional, string): The minimum memory that must be set for a container.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   This value can be used to override the currently set global value for a specific runtime. If not set,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   a global default value of &#34;12 MiB&#34; will be used.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Using the seccomp notifier feature:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This feature can help you to debug seccomp related issues, for example if</span>
</span></span><span class="line"><span class="cl"><span class="c1"># blocked syscalls (permission denied errors) have negative impact on the workload.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To be able to use this feature, configure a runtime which has the annotation</span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#34;io.kubernetes.cri-o.seccompNotifierAction&#34; in the allowed_annotations array.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># It also requires at least runc 1.1.0 or crun 0.19 which support the notifier</span>
</span></span><span class="line"><span class="cl"><span class="c1"># feature.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If everything is setup, CRI-O will modify chosen seccomp profiles for</span>
</span></span><span class="line"><span class="cl"><span class="c1"># containers if the annotation &#34;io.kubernetes.cri-o.seccompNotifierAction&#34; is</span>
</span></span><span class="line"><span class="cl"><span class="c1"># set on the Pod sandbox. CRI-O will then get notified if a container is using</span>
</span></span><span class="line"><span class="cl"><span class="c1"># a blocked syscall and then terminate the workload after a timeout of 5</span>
</span></span><span class="line"><span class="cl"><span class="c1"># seconds if the value of &#34;io.kubernetes.cri-o.seccompNotifierAction=stop&#34;.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This also means that multiple syscalls can be captured during that period,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># while the timeout will get reset once a new syscall has been discovered.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This also means that the Pods &#34;restartPolicy&#34; has to be set to &#34;Never&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># otherwise the kubelet will restart the container immediately.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Please be aware that CRI-O is not able to get notified if a syscall gets</span>
</span></span><span class="line"><span class="cl"><span class="c1"># blocked based on the seccomp defaultAction, which is a general runtime</span>
</span></span><span class="line"><span class="cl"><span class="c1"># limitation.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">crio</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">runtimes</span><span class="o">.</span><span class="n">crun</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">runtime_path</span> <span class="o">=</span> <span class="s2">&#34;/usr/libexec/crio/crun&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">runtime_type</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">runtime_root</span> <span class="o">=</span> <span class="s2">&#34;/run/crun&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">runtime_config_path</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">container_min_memory</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">monitor_path</span> <span class="o">=</span> <span class="s2">&#34;/usr/libexec/crio/conmon&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">monitor_cgroup</span> <span class="o">=</span> <span class="s2">&#34;system.slice&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">monitor_exec_cgroup</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">allowed_annotations</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;io.containers.trace-syscall&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">privileged_without_host_devices</span> <span class="o">=</span> <span class="bp">false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">crio</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">runtimes</span><span class="o">.</span><span class="n">runc</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">runtime_path</span> <span class="o">=</span> <span class="s2">&#34;/usr/libexec/crio/runc&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">runtime_type</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">runtime_root</span> <span class="o">=</span> <span class="s2">&#34;/run/runc&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">runtime_config_path</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">container_min_memory</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">monitor_path</span> <span class="o">=</span> <span class="s2">&#34;/usr/libexec/crio/conmon&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">monitor_cgroup</span> <span class="o">=</span> <span class="s2">&#34;system.slice&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">monitor_exec_cgroup</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">privileged_without_host_devices</span> <span class="o">=</span> <span class="bp">false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The workloads table defines ways to customize containers with different resources</span>
</span></span><span class="line"><span class="cl"><span class="c1"># that work based on annotations, rather than the CRI.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Note, the behavior of this table is EXPERIMENTAL and may change at any time.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Each workload, has a name, activation_annotation, annotation_prefix and set of resources it supports mutating.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The currently supported resources are &#34;cpuperiod&#34; &#34;cpuquota&#34;, &#34;cpushares&#34;, &#34;cpulimit&#34; and &#34;cpuset&#34;. The values for &#34;cpuperiod&#34; and &#34;cpuquota&#34; are denoted in microseconds.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The value for &#34;cpulimit&#34; is denoted in millicores, this value is used to calculate the &#34;cpuquota&#34; with the supplied &#34;cpuperiod&#34; or the default &#34;cpuperiod&#34;.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Note that the &#34;cpulimit&#34; field overrides the &#34;cpuquota&#34; value supplied in this configuration.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Each resource can have a default value specified, or be empty.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># For a container to opt-into this workload, the pod should be configured with the annotation $activation_annotation (key only, value is ignored).</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To customize per-container, an annotation of the form $annotation_prefix.$resource/$ctrName = &#34;value&#34; can be specified</span>
</span></span><span class="line"><span class="cl"><span class="c1"># signifying for that resource type to override the default value.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If the annotation_prefix is not present, every container in the pod will be given the default values.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Example:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [crio.runtime.workloads.workload-type]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># activation_annotation = &#34;io.crio/workload&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># annotation_prefix = &#34;io.crio.workload-type&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [crio.runtime.workloads.workload-type.resources]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cpuset = &#34;0-1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cpushares = &#34;5&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cpuquota = &#34;1000&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cpuperiod = &#34;100000&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cpulimit = &#34;35&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Where:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The workload name is workload-type.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To specify, the pod must have the &#34;io.crio.workload&#34; annotation (this is a precise string match).</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This workload supports setting cpuset and cpu resources.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># annotation_prefix is used to customize the different resources.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To configure the cpu shares a container gets in the example above, the pod would have to have the following annotation:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#34;io.crio.workload-type/$container_name = {&#34;cpushares&#34;: &#34;value&#34;}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># hostnetwork_disable_selinux determines whether</span>
</span></span><span class="line"><span class="cl"><span class="c1"># SELinux should be disabled within a pod when it is running in the host network namespace</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Default value is set to true</span>
</span></span><span class="line"><span class="cl"><span class="c1"># hostnetwork_disable_selinux = true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># disable_hostport_mapping determines whether to enable/disable</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the container hostport mapping in CRI-O.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Default value is set to &#39;false&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># disable_hostport_mapping = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># timezone To set the timezone for a container in CRI-O.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If an empty string is provided, CRI-O retains its default behavior. Use &#39;Local&#39; to match the timezone of the host machine.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># timezone = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The crio.image table contains settings pertaining to the management of OCI images.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CRI-O reads its configured registries defaults from the system wide</span>
</span></span><span class="line"><span class="cl"><span class="c1"># containers-registries.conf(5) located in /etc/containers/registries.conf. If</span>
</span></span><span class="line"><span class="cl"><span class="c1"># you want to modify just CRI-O, you can change the registries configuration in</span>
</span></span><span class="line"><span class="cl"><span class="c1"># this file. Otherwise, leave insecure_registries and registries commented out to</span>
</span></span><span class="line"><span class="cl"><span class="c1"># use the system&#39;s defaults from /etc/containers/registries.conf.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">crio</span><span class="o">.</span><span class="n">image</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Default transport for pulling images from a remote container storage.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># default_transport = &#34;docker://&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The path to a file containing credentials necessary for pulling images from</span>
</span></span><span class="line"><span class="cl"><span class="c1"># secure registries. The file is similar to that of /var/lib/kubelet/config.json</span>
</span></span><span class="line"><span class="cl"><span class="c1"># global_auth_file = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The image used to instantiate infra containers.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option supports live configuration reload.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># pause_image = &#34;registry.k8s.io/pause:3.9&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The path to a file containing credentials specific for pulling the pause_image from</span>
</span></span><span class="line"><span class="cl"><span class="c1"># above. The file is similar to that of /var/lib/kubelet/config.json</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This option supports live configuration reload.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># pause_image_auth_file = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The command to run to have a container stay in the paused state.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># When explicitly set to &#34;&#34;, it will fallback to the entrypoint and command</span>
</span></span><span class="line"><span class="cl"><span class="c1"># specified in the pause image. When commented out, it will fallback to the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># default: &#34;/pause&#34;. This option supports live configuration reload.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># pause_command = &#34;/pause&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># List of images to be excluded from the kubelet&#39;s garbage collection.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># It allows specifying image names using either exact, glob, or keyword</span>
</span></span><span class="line"><span class="cl"><span class="c1"># patterns. Exact matches must match the entire name, glob matches can</span>
</span></span><span class="line"><span class="cl"><span class="c1"># have a wildcard * at the end, and keyword matches can have wildcards</span>
</span></span><span class="line"><span class="cl"><span class="c1"># on both ends. By default, this list includes the &#34;pause&#34; image if</span>
</span></span><span class="line"><span class="cl"><span class="c1"># configured by the user, which is used as a placeholder in Kubernetes pods.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># pinned_images = [</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the file which decides what sort of policy we use when deciding</span>
</span></span><span class="line"><span class="cl"><span class="c1"># whether or not to trust an image that we&#39;ve pulled. It is not recommended that</span>
</span></span><span class="line"><span class="cl"><span class="c1"># this option be used, as the default behavior of using the system-wide default</span>
</span></span><span class="line"><span class="cl"><span class="c1"># policy (i.e., /etc/containers/policy.json) is most often preferred. Please</span>
</span></span><span class="line"><span class="cl"><span class="c1"># refer to containers-policy.json(5) for more details.</span>
</span></span><span class="line"><span class="cl"><span class="n">signature_policy</span> <span class="o">=</span> <span class="s2">&#34;/etc/crio/policy.json&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Root path for pod namespace-separated signature policies.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The final policy to be used on image pull will be &lt;SIGNATURE_POLICY_DIR&gt;/&lt;NAMESPACE&gt;.json.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If no pod namespace is being provided on image pull (via the sandbox config),</span>
</span></span><span class="line"><span class="cl"><span class="c1"># or the concatenated path is non existent, then the signature_policy or system</span>
</span></span><span class="line"><span class="cl"><span class="c1"># wide policy will be used as fallback. Must be an absolute path.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># signature_policy_dir = &#34;/etc/crio/policies&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># List of registries to skip TLS verification for pulling images. Please</span>
</span></span><span class="line"><span class="cl"><span class="c1"># consider configuring the registries via /etc/containers/registries.conf before</span>
</span></span><span class="line"><span class="cl"><span class="c1"># changing them here.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># insecure_registries = [</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Controls how image volumes are handled. The valid values are mkdir, bind and</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ignore; the latter will ignore volumes entirely.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># image_volumes = &#34;mkdir&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Temporary directory to use for storing big files</span>
</span></span><span class="line"><span class="cl"><span class="c1"># big_files_temporary_dir = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># If true, CRI-O will automatically reload the mirror registry when</span>
</span></span><span class="line"><span class="cl"><span class="c1"># there is an update to the &#39;registries.conf.d&#39; directory. Default value is set to &#39;false&#39;.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># auto_reload_registries = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The crio.network table containers settings pertaining to the management of</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CNI plugins.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">crio</span><span class="o">.</span><span class="n">network</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The default CNI network name to be selected. If not set or &#34;&#34;, then</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CRI-O will pick-up the first one found in network_dir.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cni_default_network = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Path to the directory where CNI configuration files are located.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># network_dir = &#34;/etc/cni/net.d/&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Paths to directories where CNI plugin binaries are located.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># plugin_dirs = [</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;/opt/cni/bin/&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># List of included pod metrics.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># included_pod_metrics = [</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># A necessary configuration for Prometheus based metrics retrieval</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">crio</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Globally enable or disable metrics support.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># enable_metrics = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Specify enabled metrics collectors.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Per default all metrics are enabled.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># It is possible, to prefix the metrics with &#34;container_runtime_&#34; and &#34;crio_&#34;.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># For example, the metrics collector &#34;operations&#34; would be treated in the same</span>
</span></span><span class="line"><span class="cl"><span class="c1"># way as &#34;crio_operations&#34; and &#34;container_runtime_crio_operations&#34;.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># metrics_collectors = [</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;image_pulls_layer_size&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;containers_events_dropped_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;containers_oom_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;processes_defunct&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;operations_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;operations_latency_seconds&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;operations_latency_seconds_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;operations_errors_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;image_pulls_bytes_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;image_pulls_skipped_bytes_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;image_pulls_failure_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;image_pulls_success_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;image_layer_reuse_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;containers_oom_count_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;containers_seccomp_notifier_count_total&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &#34;resources_stalled_at_stage&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The IP address or hostname on which the metrics server will listen.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># metrics_host = &#34;127.0.0.1&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The port on which the metrics server will listen.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># metrics_port = 9090</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Local socket path to bind the metrics server to</span>
</span></span><span class="line"><span class="cl"><span class="c1"># metrics_socket = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The certificate for the secure metrics server.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If the certificate is not available on disk, then CRI-O will generate a</span>
</span></span><span class="line"><span class="cl"><span class="c1"># self-signed one. CRI-O also watches for changes of this path and reloads the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># certificate on any modification event.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># metrics_cert = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The certificate key for the secure metrics server.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Behaves in the same way as the metrics_cert.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># metrics_key = &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># A necessary configuration for OpenTelemetry trace data exporting</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">crio</span><span class="o">.</span><span class="n">tracing</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Globally enable or disable exporting OpenTelemetry traces.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># enable_tracing = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Address on which the gRPC trace collector listens on.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># tracing_endpoint = &#34;0.0.0.0:4317&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Number of samples to collect per million spans. Set to 1000000 to always sample.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># tracing_sampling_rate_per_million = 0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CRI-O NRI configuration.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">crio</span><span class="o">.</span><span class="n">nri</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Globally enable or disable NRI.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># enable_nri = true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NRI socket to listen on.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># nri_listen = &#34;/var/run/nri/nri.sock&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NRI plugin directory to use.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># nri_plugin_dir = &#34;/opt/nri/plugins&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NRI plugin configuration directory to use.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># nri_plugin_config_dir = &#34;/etc/nri/conf.d&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Disable connections from externally launched NRI plugins.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># nri_disable_connections = false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Timeout for a plugin to register itself with NRI.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># nri_plugin_registration_timeout = &#34;5s&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Timeout for a plugin to handle an NRI request.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># nri_plugin_request_timeout = &#34;2s&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Necessary information pertaining to container and pod stats reporting.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">crio</span><span class="o">.</span><span class="n">stats</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The number of seconds between collecting pod and container stats.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If set to 0, the stats are collected on-demand instead.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stats_collection_period = 0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The number of seconds between collecting pod/container stats and pod</span>
</span></span><span class="line"><span class="cl"><span class="c1"># sandbox metrics. If set to 0, the metrics/stats are collected on-demand instead.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># collection_period = 0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mao</span><span class="err">@</span><span class="n">mao</span><span class="o">-</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="p">:</span><span class="o">~$</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>cri-oの設定ファイルに追記する</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo nano /etc/crio/crio.conf
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>追記する1</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[crio.runtime]
</span></span><span class="line"><span class="cl">conmon_cgroup = &#34;pod&#34;
</span></span><span class="line"><span class="cl">cgroup_manager = &#34;cgroupfs&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>追記する2</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[crio.image]
</span></span><span class="line"><span class="cl">pause_image=&#34;registry.k8s.io/pause:3.6&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[crio.image]
</span></span><span class="line"><span class="cl">- # pause_image = &#34;registry.k8s.io/pause:3.9&#34;
</span></span><span class="line"><span class="cl">+ pause_image = &#34;registry.k8s.io/pause:3.9&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">- #default_runtime = &#34;crun&#34;
</span></span><span class="line"><span class="cl">+ default_runtime = &#34;runc&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>設定を反映するためにリロードする</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo systemctl restart cri-o
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="runcとcniのインストール">runCとCNIのインストール</h2>
<ul>
<li>runC</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">opencontainers</span><span class="o">/</span><span class="n">runc</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">v1</span><span class="o">.</span><span class="mf">1.13</span><span class="o">/</span><span class="n">runc</span><span class="o">.</span><span class="n">amd64</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">install</span> <span class="o">-</span><span class="n">m</span> <span class="mi">755</span> <span class="n">runc</span><span class="o">.</span><span class="n">amd64</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">runc</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>CNI</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">containernetworking</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">v1</span><span class="o">.</span><span class="mf">5.1</span><span class="o">/</span><span class="n">cni</span><span class="o">-</span><span class="n">plugins</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="o">-</span><span class="n">v1</span><span class="o">.</span><span class="mf">5.1</span><span class="o">.</span><span class="n">tgz</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">cni</span><span class="o">/</span><span class="n">bin</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">tar</span> <span class="n">Cxzvf</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">cni</span><span class="o">/</span><span class="n">bin</span> <span class="n">cni</span><span class="o">-</span><span class="n">plugins</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="o">-</span><span class="n">v1</span><span class="o">.</span><span class="mf">5.1</span><span class="o">.</span><span class="n">tgz</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="kubeletkubeadmkubectlのインストール">&ldquo;kubelet&rdquo;,&ldquo;kubeadm&rdquo;,&ldquo;kubectl&quot;のインストール</h2>
<p>リポジトリを追加する</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.31/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg
</span></span><span class="line"><span class="cl">echo &#39;deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.31/deb/ /&#39; | sudo tee /etc/apt/sources.list.d/kubernetes.list
</span></span></code></pre></td></tr></table>
</div>
</div><p>インストールをして、バージョンを固定する</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt update
</span></span><span class="line"><span class="cl">sudo apt install kubelet kubeadm kubectl
</span></span><span class="line"><span class="cl">sudo apt-mark hold kubelet kubeadm kubectl
</span></span><span class="line"><span class="cl">sudo apt-mark showhold
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="control-planeでの作業1">Control-Planeでの作業1</h2>
<p>クラスタの初期設定をする</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo kubeadm init --apiserver-advertise-address=192.168.10.55 --pod-network-cidr=10.128.0.0/16
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">mao</span><span class="err">@</span><span class="n">mao</span><span class="o">-</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="p">:</span><span class="o">~$</span> <span class="n">sudo</span> <span class="n">kubeadm</span> <span class="n">init</span> <span class="o">--</span><span class="n">apiserver</span><span class="o">-</span><span class="n">advertise</span><span class="o">-</span><span class="n">address</span><span class="o">=</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">10.55</span> <span class="o">--</span><span class="n">pod</span><span class="o">-</span><span class="n">network</span><span class="o">-</span><span class="n">cidr</span><span class="o">=</span><span class="mf">10.128</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">16</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">init</span><span class="p">]</span> <span class="n">Using</span> <span class="n">Kubernetes</span> <span class="n">version</span><span class="p">:</span> <span class="n">v1</span><span class="o">.</span><span class="mf">31.0</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">preflight</span><span class="p">]</span> <span class="n">Running</span> <span class="n">pre</span><span class="o">-</span><span class="n">flight</span> <span class="n">checks</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">preflight</span><span class="p">]</span> <span class="n">Pulling</span> <span class="n">images</span> <span class="n">required</span> <span class="k">for</span> <span class="n">setting</span> <span class="n">up</span> <span class="n">a</span> <span class="n">Kubernetes</span> <span class="n">cluster</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">preflight</span><span class="p">]</span> <span class="n">This</span> <span class="n">might</span> <span class="n">take</span> <span class="n">a</span> <span class="n">minute</span> <span class="ow">or</span> <span class="n">two</span><span class="p">,</span> <span class="n">depending</span> <span class="n">on</span> <span class="n">the</span> <span class="n">speed</span> <span class="n">of</span> <span class="n">your</span> <span class="n">internet</span> <span class="n">connection</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">preflight</span><span class="p">]</span> <span class="n">You</span> <span class="n">can</span> <span class="n">also</span> <span class="n">perform</span> <span class="n">this</span> <span class="n">action</span> <span class="n">beforehand</span> <span class="n">using</span> <span class="s1">&#39;kubeadm config images pull&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">W0823</span> <span class="mi">13</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mf">00.855747</span>   <span class="mi">12076</span> <span class="n">checks</span><span class="o">.</span><span class="n">go</span><span class="p">:</span><span class="mi">846</span><span class="p">]</span> <span class="n">detected</span> <span class="n">that</span> <span class="n">the</span> <span class="n">sandbox</span> <span class="n">image</span> <span class="s2">&#34;registry.k8s.io/pause:3.6&#34;</span> <span class="n">of</span> <span class="n">the</span> <span class="n">container</span> <span class="n">runtime</span> <span class="n">is</span> <span class="n">inconsistent</span> <span class="n">with</span> <span class="n">that</span> <span class="n">used</span> <span class="n">by</span> <span class="n">kubeadm</span><span class="o">.</span><span class="n">It</span> <span class="n">is</span> <span class="n">recommended</span> <span class="n">to</span> <span class="n">use</span> <span class="s2">&#34;registry.k8s.io/pause:3.10&#34;</span> <span class="n">as</span> <span class="n">the</span> <span class="n">CRI</span> <span class="n">sandbox</span> <span class="n">image</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Using</span> <span class="n">certificateDir</span> <span class="n">folder</span> <span class="s2">&#34;/etc/kubernetes/pki&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Generating</span> <span class="s2">&#34;ca&#34;</span> <span class="n">certificate</span> <span class="ow">and</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Generating</span> <span class="s2">&#34;apiserver&#34;</span> <span class="n">certificate</span> <span class="ow">and</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">apiserver</span> <span class="n">serving</span> <span class="n">cert</span> <span class="n">is</span> <span class="n">signed</span> <span class="k">for</span> <span class="n">DNS</span> <span class="n">names</span> <span class="p">[</span><span class="n">kubernetes</span> <span class="n">kubernetes</span><span class="o">.</span><span class="n">default</span> <span class="n">kubernetes</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">svc</span> <span class="n">kubernetes</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">svc</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">local</span> <span class="n">mao</span><span class="o">-</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="p">]</span> <span class="ow">and</span> <span class="n">IPs</span> <span class="p">[</span><span class="mf">10.96</span><span class="o">.</span><span class="mf">0.1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.55</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Generating</span> <span class="s2">&#34;apiserver-kubelet-client&#34;</span> <span class="n">certificate</span> <span class="ow">and</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Generating</span> <span class="s2">&#34;front-proxy-ca&#34;</span> <span class="n">certificate</span> <span class="ow">and</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Generating</span> <span class="s2">&#34;front-proxy-client&#34;</span> <span class="n">certificate</span> <span class="ow">and</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Generating</span> <span class="s2">&#34;etcd/ca&#34;</span> <span class="n">certificate</span> <span class="ow">and</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Generating</span> <span class="s2">&#34;etcd/server&#34;</span> <span class="n">certificate</span> <span class="ow">and</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">etcd</span><span class="o">/</span><span class="n">server</span> <span class="n">serving</span> <span class="n">cert</span> <span class="n">is</span> <span class="n">signed</span> <span class="k">for</span> <span class="n">DNS</span> <span class="n">names</span> <span class="p">[</span><span class="n">localhost</span> <span class="n">mao</span><span class="o">-</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="p">]</span> <span class="ow">and</span> <span class="n">IPs</span> <span class="p">[</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">10.55</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="p">::</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Generating</span> <span class="s2">&#34;etcd/peer&#34;</span> <span class="n">certificate</span> <span class="ow">and</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">etcd</span><span class="o">/</span><span class="n">peer</span> <span class="n">serving</span> <span class="n">cert</span> <span class="n">is</span> <span class="n">signed</span> <span class="k">for</span> <span class="n">DNS</span> <span class="n">names</span> <span class="p">[</span><span class="n">localhost</span> <span class="n">mao</span><span class="o">-</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="p">]</span> <span class="ow">and</span> <span class="n">IPs</span> <span class="p">[</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">10.55</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="p">::</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Generating</span> <span class="s2">&#34;etcd/healthcheck-client&#34;</span> <span class="n">certificate</span> <span class="ow">and</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Generating</span> <span class="s2">&#34;apiserver-etcd-client&#34;</span> <span class="n">certificate</span> <span class="ow">and</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">certs</span><span class="p">]</span> <span class="n">Generating</span> <span class="s2">&#34;sa&#34;</span> <span class="n">key</span> <span class="ow">and</span> <span class="n">public</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubeconfig</span><span class="p">]</span> <span class="n">Using</span> <span class="n">kubeconfig</span> <span class="n">folder</span> <span class="s2">&#34;/etc/kubernetes&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubeconfig</span><span class="p">]</span> <span class="n">Writing</span> <span class="s2">&#34;admin.conf&#34;</span> <span class="n">kubeconfig</span> <span class="n">file</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubeconfig</span><span class="p">]</span> <span class="n">Writing</span> <span class="s2">&#34;super-admin.conf&#34;</span> <span class="n">kubeconfig</span> <span class="n">file</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubeconfig</span><span class="p">]</span> <span class="n">Writing</span> <span class="s2">&#34;kubelet.conf&#34;</span> <span class="n">kubeconfig</span> <span class="n">file</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubeconfig</span><span class="p">]</span> <span class="n">Writing</span> <span class="s2">&#34;controller-manager.conf&#34;</span> <span class="n">kubeconfig</span> <span class="n">file</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubeconfig</span><span class="p">]</span> <span class="n">Writing</span> <span class="s2">&#34;scheduler.conf&#34;</span> <span class="n">kubeconfig</span> <span class="n">file</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">etcd</span><span class="p">]</span> <span class="n">Creating</span> <span class="k">static</span> <span class="n">Pod</span> <span class="n">manifest</span> <span class="k">for</span> <span class="n">local</span> <span class="n">etcd</span> <span class="ow">in</span> <span class="s2">&#34;/etc/kubernetes/manifests&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">control</span><span class="o">-</span><span class="n">plane</span><span class="p">]</span> <span class="n">Using</span> <span class="n">manifest</span> <span class="n">folder</span> <span class="s2">&#34;/etc/kubernetes/manifests&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">control</span><span class="o">-</span><span class="n">plane</span><span class="p">]</span> <span class="n">Creating</span> <span class="k">static</span> <span class="n">Pod</span> <span class="n">manifest</span> <span class="k">for</span> <span class="s2">&#34;kube-apiserver&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">control</span><span class="o">-</span><span class="n">plane</span><span class="p">]</span> <span class="n">Creating</span> <span class="k">static</span> <span class="n">Pod</span> <span class="n">manifest</span> <span class="k">for</span> <span class="s2">&#34;kube-controller-manager&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">control</span><span class="o">-</span><span class="n">plane</span><span class="p">]</span> <span class="n">Creating</span> <span class="k">static</span> <span class="n">Pod</span> <span class="n">manifest</span> <span class="k">for</span> <span class="s2">&#34;kube-scheduler&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubelet</span><span class="o">-</span><span class="n">start</span><span class="p">]</span> <span class="n">Writing</span> <span class="n">kubelet</span> <span class="n">environment</span> <span class="n">file</span> <span class="n">with</span> <span class="n">flags</span> <span class="n">to</span> <span class="n">file</span> <span class="s2">&#34;/var/lib/kubelet/kubeadm-flags.env&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubelet</span><span class="o">-</span><span class="n">start</span><span class="p">]</span> <span class="n">Writing</span> <span class="n">kubelet</span> <span class="n">configuration</span> <span class="n">to</span> <span class="n">file</span> <span class="s2">&#34;/var/lib/kubelet/config.yaml&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubelet</span><span class="o">-</span><span class="n">start</span><span class="p">]</span> <span class="n">Starting</span> <span class="n">the</span> <span class="n">kubelet</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">wait</span><span class="o">-</span><span class="n">control</span><span class="o">-</span><span class="n">plane</span><span class="p">]</span> <span class="n">Waiting</span> <span class="k">for</span> <span class="n">the</span> <span class="n">kubelet</span> <span class="n">to</span> <span class="n">boot</span> <span class="n">up</span> <span class="n">the</span> <span class="n">control</span> <span class="n">plane</span> <span class="n">as</span> <span class="k">static</span> <span class="n">Pods</span> <span class="n">from</span> <span class="n">directory</span> <span class="s2">&#34;/etc/kubernetes/manifests&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubelet</span><span class="o">-</span><span class="n">check</span><span class="p">]</span> <span class="n">Waiting</span> <span class="k">for</span> <span class="n">a</span> <span class="n">healthy</span> <span class="n">kubelet</span> <span class="n">at</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">10248</span><span class="o">/</span><span class="n">healthz</span><span class="o">.</span> <span class="n">This</span> <span class="n">can</span> <span class="n">take</span> <span class="n">up</span> <span class="n">to</span> <span class="mi">4</span><span class="n">m0s</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubelet</span><span class="o">-</span><span class="n">check</span><span class="p">]</span> <span class="n">The</span> <span class="n">kubelet</span> <span class="n">is</span> <span class="n">healthy</span> <span class="n">after</span> <span class="mf">501.386574</span><span class="n">ms</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">api</span><span class="o">-</span><span class="n">check</span><span class="p">]</span> <span class="n">Waiting</span> <span class="k">for</span> <span class="n">a</span> <span class="n">healthy</span> <span class="n">API</span> <span class="n">server</span><span class="o">.</span> <span class="n">This</span> <span class="n">can</span> <span class="n">take</span> <span class="n">up</span> <span class="n">to</span> <span class="mi">4</span><span class="n">m0s</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">api</span><span class="o">-</span><span class="n">check</span><span class="p">]</span> <span class="n">The</span> <span class="n">API</span> <span class="n">server</span> <span class="n">is</span> <span class="n">healthy</span> <span class="n">after</span> <span class="mf">5.501313388</span><span class="n">s</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">upload</span><span class="o">-</span><span class="n">config</span><span class="p">]</span> <span class="n">Storing</span> <span class="n">the</span> <span class="n">configuration</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">ConfigMap</span> <span class="s2">&#34;kubeadm-config&#34;</span> <span class="ow">in</span> <span class="n">the</span> <span class="s2">&#34;kube-system&#34;</span> <span class="n">Namespace</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubelet</span><span class="p">]</span> <span class="n">Creating</span> <span class="n">a</span> <span class="n">ConfigMap</span> <span class="s2">&#34;kubelet-config&#34;</span> <span class="ow">in</span> <span class="n">namespace</span> <span class="n">kube</span><span class="o">-</span><span class="n">system</span> <span class="n">with</span> <span class="n">the</span> <span class="n">configuration</span> <span class="k">for</span> <span class="n">the</span> <span class="n">kubelets</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">cluster</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">upload</span><span class="o">-</span><span class="n">certs</span><span class="p">]</span> <span class="n">Skipping</span> <span class="n">phase</span><span class="o">.</span> <span class="n">Please</span> <span class="n">see</span> <span class="o">--</span><span class="n">upload</span><span class="o">-</span><span class="n">certs</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">mark</span><span class="o">-</span><span class="n">control</span><span class="o">-</span><span class="n">plane</span><span class="p">]</span> <span class="n">Marking</span> <span class="n">the</span> <span class="n">node</span> <span class="n">mao</span><span class="o">-</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span> <span class="n">as</span> <span class="n">control</span><span class="o">-</span><span class="n">plane</span> <span class="n">by</span> <span class="n">adding</span> <span class="n">the</span> <span class="n">labels</span><span class="p">:</span> <span class="p">[</span><span class="n">node</span><span class="o">-</span><span class="n">role</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">control</span><span class="o">-</span><span class="n">plane</span> <span class="n">node</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">exclude</span><span class="o">-</span><span class="n">from</span><span class="o">-</span><span class="n">external</span><span class="o">-</span><span class="nb">load</span><span class="o">-</span><span class="n">balancers</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">mark</span><span class="o">-</span><span class="n">control</span><span class="o">-</span><span class="n">plane</span><span class="p">]</span> <span class="n">Marking</span> <span class="n">the</span> <span class="n">node</span> <span class="n">mao</span><span class="o">-</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span> <span class="n">as</span> <span class="n">control</span><span class="o">-</span><span class="n">plane</span> <span class="n">by</span> <span class="n">adding</span> <span class="n">the</span> <span class="n">taints</span> <span class="p">[</span><span class="n">node</span><span class="o">-</span><span class="n">role</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">control</span><span class="o">-</span><span class="n">plane</span><span class="p">:</span><span class="n">NoSchedule</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">token</span><span class="p">]</span> <span class="n">Using</span> <span class="n">token</span><span class="p">:</span> <span class="n">chwroq</span><span class="o">.</span><span class="n">m0rdyxckr4zb0qpb</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">token</span><span class="p">]</span> <span class="n">Configuring</span> <span class="n">bootstrap</span> <span class="n">tokens</span><span class="p">,</span> <span class="n">cluster</span><span class="o">-</span><span class="n">info</span> <span class="n">ConfigMap</span><span class="p">,</span> <span class="n">RBAC</span> <span class="n">Roles</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">token</span><span class="p">]</span> <span class="n">Configured</span> <span class="n">RBAC</span> <span class="n">rules</span> <span class="n">to</span> <span class="n">allow</span> <span class="ne">Node</span> <span class="n">Bootstrap</span> <span class="n">tokens</span> <span class="n">to</span> <span class="n">get</span> <span class="n">nodes</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">token</span><span class="p">]</span> <span class="n">Configured</span> <span class="n">RBAC</span> <span class="n">rules</span> <span class="n">to</span> <span class="n">allow</span> <span class="ne">Node</span> <span class="n">Bootstrap</span> <span class="n">tokens</span> <span class="n">to</span> <span class="n">post</span> <span class="n">CSRs</span> <span class="ow">in</span> <span class="n">order</span> <span class="k">for</span> <span class="n">nodes</span> <span class="n">to</span> <span class="n">get</span> <span class="n">long</span> <span class="n">term</span> <span class="n">certificate</span> <span class="n">credentials</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">token</span><span class="p">]</span> <span class="n">Configured</span> <span class="n">RBAC</span> <span class="n">rules</span> <span class="n">to</span> <span class="n">allow</span> <span class="n">the</span> <span class="n">csrapprover</span> <span class="n">controller</span> <span class="n">automatically</span> <span class="n">approve</span> <span class="n">CSRs</span> <span class="n">from</span> <span class="n">a</span> <span class="ne">Node</span> <span class="n">Bootstrap</span> <span class="n">Token</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">token</span><span class="p">]</span> <span class="n">Configured</span> <span class="n">RBAC</span> <span class="n">rules</span> <span class="n">to</span> <span class="n">allow</span> <span class="n">certificate</span> <span class="n">rotation</span> <span class="k">for</span> <span class="n">all</span> <span class="n">node</span> <span class="n">client</span> <span class="n">certificates</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">cluster</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">token</span><span class="p">]</span> <span class="n">Creating</span> <span class="n">the</span> <span class="s2">&#34;cluster-info&#34;</span> <span class="n">ConfigMap</span> <span class="ow">in</span> <span class="n">the</span> <span class="s2">&#34;kube-public&#34;</span> <span class="n">namespace</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">kubelet</span><span class="o">-</span><span class="n">finalize</span><span class="p">]</span> <span class="n">Updating</span> <span class="s2">&#34;/etc/kubernetes/kubelet.conf&#34;</span> <span class="n">to</span> <span class="n">point</span> <span class="n">to</span> <span class="n">a</span> <span class="n">rotatable</span> <span class="n">kubelet</span> <span class="n">client</span> <span class="n">certificate</span> <span class="ow">and</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">addons</span><span class="p">]</span> <span class="n">Applied</span> <span class="n">essential</span> <span class="n">addon</span><span class="p">:</span> <span class="n">CoreDNS</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">addons</span><span class="p">]</span> <span class="n">Applied</span> <span class="n">essential</span> <span class="n">addon</span><span class="p">:</span> <span class="n">kube</span><span class="o">-</span><span class="n">proxy</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Your</span> <span class="n">Kubernetes</span> <span class="n">control</span><span class="o">-</span><span class="n">plane</span> <span class="n">has</span> <span class="n">initialized</span> <span class="n">successfully</span><span class="o">!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">To</span> <span class="n">start</span> <span class="n">using</span> <span class="n">your</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">you</span> <span class="n">need</span> <span class="n">to</span> <span class="n">run</span> <span class="n">the</span> <span class="n">following</span> <span class="n">as</span> <span class="n">a</span> <span class="n">regular</span> <span class="n">user</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">$</span><span class="n">HOME</span><span class="o">/.</span><span class="n">kube</span>
</span></span><span class="line"><span class="cl">  <span class="n">sudo</span> <span class="n">cp</span> <span class="o">-</span><span class="n">i</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">admin</span><span class="o">.</span><span class="n">conf</span> <span class="o">$</span><span class="n">HOME</span><span class="o">/.</span><span class="n">kube</span><span class="o">/</span><span class="n">config</span>
</span></span><span class="line"><span class="cl">  <span class="n">sudo</span> <span class="n">chown</span> <span class="o">$</span><span class="p">(</span><span class="n">id</span> <span class="o">-</span><span class="n">u</span><span class="p">):</span><span class="o">$</span><span class="p">(</span><span class="n">id</span> <span class="o">-</span><span class="n">g</span><span class="p">)</span> <span class="o">$</span><span class="n">HOME</span><span class="o">/.</span><span class="n">kube</span><span class="o">/</span><span class="n">config</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Alternatively</span><span class="p">,</span> <span class="k">if</span> <span class="n">you</span> <span class="n">are</span> <span class="n">the</span> <span class="n">root</span> <span class="n">user</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">run</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">export</span> <span class="n">KUBECONFIG</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">admin</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">You</span> <span class="n">should</span> <span class="n">now</span> <span class="n">deploy</span> <span class="n">a</span> <span class="n">pod</span> <span class="n">network</span> <span class="n">to</span> <span class="n">the</span> <span class="n">cluster</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">Run</span> <span class="s2">&#34;kubectl apply -f [podnetwork].yaml&#34;</span> <span class="n">with</span> <span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="n">options</span> <span class="n">listed</span> <span class="n">at</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">concepts</span><span class="o">/</span><span class="n">cluster</span><span class="o">-</span><span class="n">administration</span><span class="o">/</span><span class="n">addons</span><span class="o">/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Then</span> <span class="n">you</span> <span class="n">can</span> <span class="n">join</span> <span class="n">any</span> <span class="n">number</span> <span class="n">of</span> <span class="n">worker</span> <span class="n">nodes</span> <span class="n">by</span> <span class="n">running</span> <span class="n">the</span> <span class="n">following</span> <span class="n">on</span> <span class="n">each</span> <span class="n">as</span> <span class="n">root</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubeadm</span> <span class="n">join</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.55</span><span class="p">:</span><span class="mi">6443</span> <span class="o">--</span><span class="n">token</span> <span class="n">chwroq</span><span class="o">.</span><span class="n">m0rdyxckr4zb0qpb</span> \
</span></span><span class="line"><span class="cl">        <span class="o">--</span><span class="n">discovery</span><span class="o">-</span><span class="n">token</span><span class="o">-</span><span class="n">ca</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="nb">hash</span> <span class="n">sha256</span><span class="p">:</span><span class="n">e2abcd3797f4c417d228e4ffeb65f2215498933d2057d511701881b49625e629</span> 
</span></span><span class="line"><span class="cl"><span class="n">mao</span><span class="err">@</span><span class="n">mao</span><span class="o">-</span><span class="n">cri</span><span class="o">-</span><span class="n">o</span><span class="p">:</span><span class="o">~$</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>joinコマンドの再表示</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo kubeadm token create --print-join-command
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="control-planeでの作業2">Control-Planeでの作業2</h2>
<p>Calicoをインストールする</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">wget https://raw.githubusercontent.com/projectcalico/calico/v3.28.1/manifests/tigera-operator.yaml
</span></span><span class="line"><span class="cl">kubectl create -f tigera-operator.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">wget https://raw.githubusercontent.com/projectcalico/calico/v3.28.1/manifests/custom-resources.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">- cidr: 192.168.0.0/16
</span></span><span class="line"><span class="cl">+ cidr: 10.128.0.0/16
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl apply -f custom-resources.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="woker-nodeでの作業">Woker-Nodeでの作業</h2>
<p>クラスタにjoinするコマンドを実行する</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo kubeadm join 192.168.10.55:6443 --token chwroq.m0rdyxckr4zb0qpb \
</span></span><span class="line"><span class="cl">        --discovery-token-ca-cert-hash sha256:e2abcd3797f4c417d228e4ffeb65f2215498933d2057d511701881b49625e629
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="確認">確認</h2>
<p>クラスタにjoinされていることを確認する</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get nodes -o wide
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mao@mao-cri-o:~$ kubectl get nodes -o wide
</span></span><span class="line"><span class="cl">NAME                    STATUS   ROLES           AGE   VERSION   INTERNAL-IP     EXTERNAL-IP   OS-IMAGE           KERNEL-VERSION     CONTAINER-RUNTIME
</span></span><span class="line"><span class="cl">mao-cri-o               Ready    control-plane   35m   v1.31.0   192.168.10.55   &lt;none&gt;        Ubuntu 24.04 LTS   6.8.0-41-generic   cri-o://1.30.4
</span></span><span class="line"><span class="cl">mao-cri-o-worker-node   Ready    &lt;none&gt;          32s   v1.31.0   192.168.10.56   &lt;none&gt;        Ubuntu 24.04 LTS   6.8.0-41-generic   cri-o://1.30.4
</span></span><span class="line"><span class="cl">mao@mao-cri-o:~$
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="コンテナランタイムが混ぜる">コンテナランタイムが混ぜる</h2>
<p>containerdのクラスタにcri-oのNodeをjoinしようとしたらエラーになりコンテナランタイムを混ぜての構築はできなかった</p>

</section>


    <footer class="article-footer">
    

    

    
</footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">関連するコンテンツ</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="../../post/kubernetes-longhorn/">
        
        

        <div class="article-details">
            <h2 class="article-title">KubernetesにLonghornをインストールする</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="../../post/kubernetes-ingress-traefik/">
        
        

        <div class="article-details">
            <h2 class="article-title">KubernetesでTraefikを使用してIngressを使えるようにする</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="../../post/kubernetes-upgrade-v1-31-0/">
        
        

        <div class="article-details">
            <h2 class="article-title">Kubernetesのクラスタをv1.30.3からv1.31.0へアップグレードをする</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="../../post/kubernetes-pv-pvc/">
        
        

        <div class="article-details">
            <h2 class="article-title">NFS-serverを構築してPV(PersistentVolume)を作成する</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="../../post/kubernetes-upgrade-v1-30-3/">
        
        

        <div class="article-details">
            <h2 class="article-title">Kubernetesのクラスタをv1.30.2からv1.30.3へアップグレードをする</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2024 onodera
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        テーマ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.21.0">Stack</a></b> は <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> によって設計されています。
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="../../ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
